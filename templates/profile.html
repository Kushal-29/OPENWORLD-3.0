{% extends "base.html" %}

{% block title %}{{ profile_user.full_name or profile_user.username }} - OPENWORLD{% endblock %}

{% block content %}
<div style="max-width: 800px; margin: 0 auto;">

    <!-- PROFILE HEADER -->
    <div class="profile-header">

        <!-- PROFILE AVATAR -->
        <div class="profile-avatar">
            <img
                src="{% if profile_user.profile_pic %}
                        /static/uploads/profiles/{{ profile_user.profile_pic }}?v={{ profile_user.id }}
                     {% else %}
                        /static/uploads/profiles/default.png
                     {% endif %}"
                alt="{{ profile_user.username }}"
                onerror="this.src='/static/uploads/profiles/default.png'">
        </div>

        <div style="flex: 1;">
            <h2 style="font-size: 24px; font-weight: 700; margin-bottom: 8px; letter-spacing: -0.5px;">{{ profile_user.full_name or 'No Name' }}</h2>
            <div class="profile-username">@{{ profile_user.username }}</div>

            <div class="profile-meta">
                {% if profile_user.age %}
                <div class="profile-meta-item">
                    üéÇ {{ profile_user.age }} years old
                </div>
                {% endif %}

                {% if profile_user.country %}
                <div class="profile-meta-item">
                    üåç From {{ profile_user.country }}
                </div>
                {% endif %}
            </div>

            <!-- STATS -->
            <div class="profile-stats">
                <div class="profile-stat">
                    <div class="profile-stat-number">
                        {% if current_user.id == profile_user.id %}
                            {{ current_user.friends.count() }}
                        {% else %}
                            0
                        {% endif %}
                    </div>
                    <div class="profile-stat-label">Friends</div>
                </div>
            </div>

            <!-- ACTION BUTTONS -->
            <div style="display: flex; gap: 12px; margin-top: 20px; flex-wrap: wrap;">
                {% if current_user.id == profile_user.id %}
                    <a href="{{ url_for('profile.edit_profile') }}" class="btn">
                        Edit Profile
                    </a>
                {% else %}
                    {% if is_friend %}
                        <a href="{{ url_for('chat.chat_window', user_id=profile_user.id) }}" class="btn">
                            Message
                        </a>
                    {% else %}
                        <button class="btn btn-success" onclick="sendFriendRequest()">
                            Add Friend
                        </button>
                    {% endif %}
                {% endif %}
            </div>

        </div>
    </div>

    <!-- BIO -->
    {% if profile_user.bio %}
    <div class="profile-bio">
        <h3>About</h3>
        <p>{{ profile_user.bio }}</p>
    </div>
    {% endif %}

    <!-- ACCOUNT INFO -->
    <div class="card">
        <h3 style="font-size: 16px; font-weight: 700; margin-bottom: 16px;">Account Information</h3>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">

            <div>
                <div style="color: var(--text-secondary); font-size: 13px; margin-bottom: 4px;">Email</div>
                <div style="font-weight: 500; font-size: 14px;">
                    {{ profile_user.email or 'Not provided' }}
                </div>
            </div>

            <div>
                <div style="color: var(--text-secondary); font-size: 13px; margin-bottom: 4px;">Member Since</div>
                <div style="font-weight: 500; font-size: 14px;">
                    {{ profile_user.created_at.strftime('%B %Y') }}
                </div>
            </div>

            <div>
                <div style="color: var(--text-secondary); font-size: 13px; margin-bottom: 4px;">Last Seen</div>
                <div style="font-weight: 500; font-size: 14px;">
                    {% if profile_user.last_seen %}
                        {{ profile_user.last_seen.strftime('%B %d, %Y') }}
                    {% else %}
                        Never
                    {% endif %}
                </div>
            </div>

            <div>
                <div style="color: var(--text-secondary); font-size: 13px; margin-bottom: 4px;">Status</div>
                <div style="font-weight: 500; font-size: 14px; color: var(--secondary);">
                    üü¢ Active
                </div>
            </div>

        </div>
    </div>

</div>

<script>
function sendFriendRequest() {
    alert('Friend request feature - coming soon');
}
</script>
{% endblock %}